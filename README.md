TODO:
-------------------
Deal with variables
Build trees
Build layers
Add a refine option
Working fold
tfold support